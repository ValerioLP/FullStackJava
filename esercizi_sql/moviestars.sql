/* Si vuole creare un gestionale per il cinema "MovieStars" con le seguenti caratteristiche: 

- Vogliamo memorizzare una anagrafica delle sale presenti nel cinema indicando
	+ posti, 
	+ nome
	+ città di appartenenza

- Nell'arco di una giornata, una sala può ospitare più film e un film può essere proiettato all'interno della stessa sala in momenti diversi della giornata

- Per ogni film proiettato nelle sale vogliamo gestire le seguenti informazioni: 
	+ Titolo, Anno di produzione, nazionalità, regista e il genere. 

- Per ogni film, vogliamo gestire informazioni relative agli attori: 
	+ Nome, Anno di nascita e nazionalità  */
  
 CREATE DATABASE moviestars
    WITH 
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'Italian_Italy.1252'
    LC_CTYPE = 'Italian_Italy.1252'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1;
    
CREATE TABLE IF NOT EXISTS public.film
(
    codice integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    titolo character varying(25) COLLATE pg_catalog."default" NOT NULL,
    genere character varying(25) COLLATE pg_catalog."default" NOT NULL,
    anno_produzione date NOT NULL,
    "nazionalità" character varying(25) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT film_pkey PRIMARY KEY (codice)
)

CREATE TABLE IF NOT EXISTS public.artista
(
    codice_fiscale character varying(20) COLLATE pg_catalog."default" NOT NULL,
    nome character varying(25) COLLATE pg_catalog."default" NOT NULL,
    cognome character varying(25) COLLATE pg_catalog."default" NOT NULL,
    "nazionalità" character varying(25) COLLATE pg_catalog."default" NOT NULL,
    anno_nascita date NOT NULL,
    tipo character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT artista_pkey PRIMARY KEY (codice_fiscale)
)

CREATE TABLE IF NOT EXISTS public.cinema
(
    codice integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    nome character varying(25) COLLATE pg_catalog."default" NOT NULL,
    "città" character varying(25) COLLATE pg_catalog."default" NOT NULL,
    numero_sale integer,
    CONSTRAINT cinema_pkey PRIMARY KEY (codice)
)

CREATE TABLE IF NOT EXISTS public.sala
(
    codice_cinema integer NOT NULL,
    numero_sala smallint NOT NULL,
    numero_posti integer,
    CONSTRAINT sala_pkey PRIMARY KEY (codice_cinema, numero_sala),
    CONSTRAINT fk_cinema FOREIGN KEY (codice_cinema)
        REFERENCES public.cinema (codice) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

CREATE TABLE IF NOT EXISTS public.spettacolo
(
    codice_cinema integer NOT NULL,
    numero_sala smallint NOT NULL,
    codice_film integer NOT NULL,
    orario time without time zone NOT NULL,
    data date NOT NULL,
    CONSTRAINT spettacolo_pkey PRIMARY KEY (codice_cinema, numero_sala, codice_film, orario, data),
    CONSTRAINT fk_film FOREIGN KEY (codice_film)
        REFERENCES public.film (codice) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_sala_cinema FOREIGN KEY (codice_cinema, numero_sala)
        REFERENCES public.sala (codice_cinema, numero) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

CREATE TABLE IF NOT EXISTS public."cast"
(
    codice_film integer NOT NULL,
    cf_artista character varying(25) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT cast_pkey PRIMARY KEY (codice_film, cf_artista),
    CONSTRAINT fk_artista FOREIGN KEY (cf_artista)
        REFERENCES public.artista (codice_fiscale) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_film FOREIGN KEY (codice_film)
        REFERENCES public.film (codice) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

CREATE TABLE IF NOT EXISTS public.composizione
(
    codice_cinema integer NOT NULL,
    sala smallint NOT NULL,
    CONSTRAINT composizione_pkey PRIMARY KEY (codice_cinema, sala),
    CONSTRAINT fk_cinema FOREIGN KEY (codice_cinema)
        REFERENCES public.cinema (codice) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_sala FOREIGN KEY (sala, sala)
        REFERENCES public.sala (codice_cinema, numero) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
    
insert into artista(codice_fiscale,nome,nazionalità,anno_nascita, tipo) 
		     values('XYZABC01A05H501D','Malenia','francese','2001-01-05','Attore');
insert into artista(codice_fiscale,nome,nazionalità,anno_nascita, tipo) 
		     values('XYZABC00B07H501D','Ranni','italiana','2000-02-07','Attore');
insert into artista(codice_fiscale,nome,nazionalità,anno_nascita, tipo) 
		     values('XYZABC99D12H501N','Nepheli','americana','1999-04-12','Attore');
insert into artista(codice_fiscale,nome,nazionalità,anno_nascita, tipo) 
		     values('XYZABC55B21H501S','Miyazaki','giapponese','1955-02-21','Regista');

insert into cinema(nome,città,numero_sale) 
		     values('UCI Cinema Porta di Roma','Roma', 14);
insert into cinema(nome,città,numero_sale) 
		     values('UCI Cinema Roma Est','Roma', 12);
insert into cinema(nome,città,numero_sale) 
		     values('Atlantic','Parigi', 10);
insert into cinema(nome,città,numero_sale) 
		     values('Maximo','Madrid',20);
insert into cinema(nome,città,numero_sale) 
		     values('Franx','Nizza',8);
		     
insert into film(titolo,genere,anno_produzione,nazionalità) 
		     values('The Day After Tomorrow','Fantascienza', '2004-01-01','USA');
insert into film(titolo,genere,anno_produzione,nazionalità) 
		     values('Inception','Fantascienza', '2010-01-01','USA');
insert into film(titolo,genere,anno_produzione,nazionalità) 
		     values('Iron Man','Azione', '2008-01-01','USA');
insert into film(titolo,genere,anno_produzione,nazionalità) 
		     values('Spider Man','Azione', '2002-01-01','USA');

insert into sala(codice_cinema,numero,numero_posti) values(1,1,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,2,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,3,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,4,200);
insert into sala(codice_cinema,numero,numero_posti) values(1,5,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,6,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,7,150);
insert into sala(codice_cinema,numero,numero_posti) values(1,8,80);
insert into sala(codice_cinema,numero,numero_posti) values(1,9,140);
insert into sala(codice_cinema,numero,numero_posti) values(1,10,90);
insert into sala(codice_cinema,numero,numero_posti) values(1,11,100);
insert into sala(codice_cinema,numero,numero_posti) values(1,12,110);
insert into sala(codice_cinema,numero,numero_posti) values(1,13,120);
insert into sala(codice_cinema,numero,numero_posti) values(1,14,180);
insert into sala(codice_cinema,numero,numero_posti) values(2,1,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,2,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,3,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,4,200);
insert into sala(codice_cinema,numero,numero_posti) values(2,5,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,6,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,7,150);
insert into sala(codice_cinema,numero,numero_posti) values(2,8,80);
insert into sala(codice_cinema,numero,numero_posti) values(2,9,140);
insert into sala(codice_cinema,numero,numero_posti) values(2,10,90);
insert into sala(codice_cinema,numero,numero_posti) values(2,11,100);
insert into sala(codice_cinema,numero,numero_posti) values(2,12,110);
insert into sala(codice_cinema,numero,numero_posti) values(3,1,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,2,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,3,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,4,200);
insert into sala(codice_cinema,numero,numero_posti) values(3,5,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,6,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,7,150);
insert into sala(codice_cinema,numero,numero_posti) values(3,8,80);
insert into sala(codice_cinema,numero,numero_posti) values(3,9,140);
insert into sala(codice_cinema,numero,numero_posti) values(3,10,90);
insert into sala(codice_cinema,numero,numero_posti) values(4,1,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,2,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,3,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,4,200);
insert into sala(codice_cinema,numero,numero_posti) values(4,5,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,6,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,7,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,8,80);
insert into sala(codice_cinema,numero,numero_posti) values(4,9,140);
insert into sala(codice_cinema,numero,numero_posti) values(4,10,90);
insert into sala(codice_cinema,numero,numero_posti) values(4,11,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,12,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,13,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,14,200);
insert into sala(codice_cinema,numero,numero_posti) values(4,15,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,16,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,17,150);
insert into sala(codice_cinema,numero,numero_posti) values(4,18,80);
insert into sala(codice_cinema,numero,numero_posti) values(4,19,140);
insert into sala(codice_cinema,numero,numero_posti) values(4,20,90);
insert into sala(codice_cinema,numero,numero_posti) values(5,1,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,2,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,3,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,4,200);
insert into sala(codice_cinema,numero,numero_posti) values(5,5,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,6,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,7,150);
insert into sala(codice_cinema,numero,numero_posti) values(5,8,80);

insert into "cast"(codice_film,cf_artista) values(1,'XYZABC01A05H501D');
insert into "cast"(codice_film,cf_artista) values(3,'XYZABC01A05H501D');
insert into "cast"(codice_film,cf_artista) values(1,'XYZABC00B07H501D');
insert into "cast"(codice_film,cf_artista) values(2,'XYZABC00B07H501D');
insert into "cast"(codice_film,cf_artista) values(3,'XYZABC00B07H501D');
insert into "cast"(codice_film,cf_artista) values(1,'XYZABC55B21H501S');
insert into "cast"(codice_film,cf_artista) values(2,'XYZABC55B21H501S');
insert into "cast"(codice_film,cf_artista) values(3,'XYZABC55B21H501S');
insert into "cast"(codice_film,cf_artista) values(4,'XYZABC55B21H501S');
insert into "cast"(codice_film,cf_artista) values(2,'XYZABC99D12H501N');
insert into "cast"(codice_film,cf_artista) values(2,'XYZABC99D12H501N');
